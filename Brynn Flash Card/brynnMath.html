<!DOCTYPE html>
<html>
<head>
<title>
Brynn's Math Page
</title>

<link rel="stylesheet" type="text/css" href="styles.css">

<style type="text/css">
  #nextQuestion, #totalIncorrect, #totalCorrect, #totalQuestions{
    display: none;
  }
</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script type="text/javascript">

$( document ).ready(function() {
    console.log( "ready!" );


var multiplier;
var multiplicand;
var tryCounter = 0;
var correctAnswer;
var totalIncorrect = 0;
var totalCorrect = 0;
var totalQuestions = 4;
var currentQuestion = 1;
var myAnswer;
var firstAnswer;

function getRandomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}



function resetPage() {
  $("#qtext").text("Question ");
  totalIncorrect = 0;
  totalCorrect = 0;
  currentQuestion = 1;
  tryCounter = 1;
  $("#submitAnswer").css('display','block');
  $("#totalCorrect").text("");
  $("#totalIncorrect").text("");
  $("#totalQuestions").text("");
  initPage();
}

function initPage() {
  multiplier = getRandomInt(1,12);
  multiplicand = getRandomInt(1,12);
  tryCounter = 1;
  $("#multiplicand").text(multiplicand);
  $("#multiplier").text(multiplier);
  correctAnswer = (multiplier * multiplicand);
  $("#correctAnswer").text(correctAnswer);
  $("#currentQuestion").css('display','inline');
  $("#currentQuestion").text(currentQuestion);
  $("#submitAnswer").css('display','block');
  $("#submitButton").css('display','block');
  $("#nextQuestion").css('display','none');
  $("#problem").css('display', 'block');
  $("#tryAgain").css('display','none');
  $("#showResults").css('display','none');
  $("#question").css('display', 'block');
  $("#qtext").css('display', 'inline');
  $("#submitAnswer").val("").focus();
  $("#rejoinder").text("");
}

function showResults(){
  
    $("#qtext").text("Here are your results!");
    $("#totalCorrect").text("Number of questions answered correctly: "+totalCorrect);
    $("#totalIncorrect").text("Number of questions answered incorrectly: "+totalIncorrect);
    $("#totalQuestions").text("Total number of questions in this quiz: "+totalQuestions);
    $("#statistics").css('display', 'block');
    $("#totalCorrect").css('display', 'block');
    $("#totalIncorrect").css('display', 'block');
    $("#totalQuestions").css('display', 'block');
    $("#currentQuestion").css('display','none');
    $("#submitButton").css('display','none');
    $("#showResults").css('display','none');
    $("#nextQuestion").css('display','none');
    $("#tryAgain").css('display','block');
    $("#question").css('display', 'none');
    $("#problem").css('display', 'none');
    $("#submitAnswer").css('display','none');
    console.log("last Question,exiting statistics block, next line increments current question, value of current question is: "+currentQuestion);
    console.log("Leaving showResults funtion block, value of current question is is: "+currentQuestion);
}



function myFunction(theAnswer) 
{
  correctAnswer = (multiplier * multiplicand);
  
  if (currentQuestion < totalQuestions)
  {
    if (tryCounter <= 3)
    {
      if (theAnswer == correctAnswer)
      {
        $("#rejoinder").text("Correct!");
        totalCorrect++;
        currentQuestion++;
        //++currentQuestion;
        console.log("Increment totalCorrect, value now :"+totalCorrect);
        $("#nextQuestion").css('display','block');
        $("#submitButton").css('display','none');
        
      }
      else
      { 
        $("#submitAnswer").val("").focus();; 
        if (tryCounter == 1)
          {
            $("#rejoinder").text("Sorry, but "+theAnswer+" isn't correct. Try again.");
            firstAnswer = theAnswer;
          }
        if (tryCounter == 2)
          {
          if (theAnswer != firstAnswer)
            $("#rejoinder").text("Sorry, but "+theAnswer+" isn't correct. Nor was your first answer of "+firstAnswer+". Try again.");
          else
            $("#rejoinder").text("Sorry, but "+theAnswer+" was what you answered for your first attempt. One more try.");
          }
        if (tryCounter == 3)
          {
            $("#rejoinder").text("Sorry, but the correct answer is "+correctAnswer+". Let's try another question.");
            $("#nextQuestion").css('display','block');
            $("#submitButton").css('display','none');
            totalIncorrect++;
            currentQuestion++;
            //++currentQuestion;
            console.log("Increment totalInorrect, value now :"+totalIncorrect);
            
          }
        else{console.log("Try Counter out of bounds.");}
      }
    }
  //++tryCounter;
  tryCounter++;
  console.log("increased tryCounter in question less than max if block, value now: "+tryCounter);
  //currentQuestion++;
console.log("after incrementing current question, value is: "+currentQuestion);
  }

/*
Separate compound if statement and put logic in to show the show result button, and then reset page after a correct answer for the last question, or 3 incorrect responses. Verify that the data calculates and displays correctly.
*/
  
if (currentQuestion == totalQuestions)
 //if ((currentQuestion == totalQuestions) && ((totalCorrect + totalIncorrect)==totalQuestions))
  {
    console.log("last Question,Entered else if current == total");
    if (tryCounter <= 3)
    {
      console.log("last Question,try counter less than 3 check, value of trycounter is now: "+tryCounter);
      if (theAnswer == correctAnswer)
      {
        console.log("Entered else if theAnswer == correct");
        $("#rejoinder").text("Correct!");
        totalCorrect++;
        console.log("Last Question, totalCorrect incremented, Value of totalCorrect now equals: "+totalCorrect);
        if (((totalCorrect + totalIncorrect)==totalQuestions) && (totalQuestions>0)){
        $("#submitButton").css('display','none');
        $("#showResults").css('display','block');
      }
      }
      else
      {
        $("#submitAnswer").val("").focus();; 
        if (tryCounter == 1)
        {
          console.log("Last Question,tc equals 1 -- incorrect answer try counter equals "+tryCounter);
          $("#rejoinder").text("Sorry, but "+theAnswer+" isn't correct. Try again.");
          firstAnswer = theAnswer;
        }
        if (tryCounter == 2)
        {
          console.log("last Question,tc equals 2 -- incorrect answer try counter equals "+tryCounter);
        if (theAnswer != firstAnswer)
          $("#rejoinder").text("Sorry, but "+theAnswer+" isn't correct. Nor was your first answer of "+firstAnswer+". Try again.");
        else
          $("#rejoinder").text("Sorry, but "+theAnswer+" was what you answered for your first attempt. One more try.");
        }
        if (tryCounter == 3)
        {
          console.log("last Question,tc equals 3 -- incorrect answer try counter equals "+tryCounter);
          totalIncorrect++;
          $("#rejoinder").text("Sorry, but the correct answer is "+correctAnswer+". We would try another question but this is the last question in this quiz.");

          if (((totalCorrect + totalIncorrect)==totalQuestions) && (totalQuestions>0)){
          
          $("#submitButton").css('display','none');
          $("#showResults").css('display','block');}
        }
        else{console.log("Last Question,Try Counter out of bounds in the final question.");}
      console.log("Last Question,incorrect answer, try counter equals: "+tryCounter);
        
      }
      //++tryCounter;
      tryCounter++;
      console.log("last Question,increased try counter in current question is max question, value of try counter now: "+tryCounter);
      console.log("last Question,exit else if trycounter leq 3, value of trycounter is:  "+tryCounter);
    }    
  }
}

$("#submitButton").click(function(){
   myAnswer = $("#submitAnswer").val();
   myFunction(myAnswer);
});//end submit button click

$("#tryAgain").click(function(){
   resetPage();
}); //end reset page on try again click


$("#showResults").click(function(){
   showResults();
});

$("#nextQuestion").click(function(){
  initPage();
});

initPage();

});//end document ready
</script>
</head>

<body>
<div id="mainDiv">
<div id="statistics">
<h1><span id="qtext">Question </span><span id="currentQuestion"></span></h1>

<span id="totalCorrect">Number of questions answered correctly: </span>
<span id="totalIncorrect">Number of questions answered incorrectly: </span>
<span id="totalQuestions">Total number of questions for this quiz: </span></div>


<p id="question">What is the solution to the equation given?</p>

<div id="problem">
  <span id="multiplicand"></span> x <span id="multiplier"></span> =  ?
</div>
<br/>

<input type="text" id="submitAnswer" />

<br/><br/>
<button type="button" id="submitButton">Submit</button><button type="button" id="nextQuestion">Next Question</button><button type="button" id="showResults">Show Results!</button><button type="button" id="tryAgain">Try Again?</button>
<br/><br/>
<span id="rejoinder"></span>

</div>
</body>
</html>